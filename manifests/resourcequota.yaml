# ResourceQuota для namespace xui-vpn
# Ограничивает общие ресурсы всех подов в namespace
apiVersion: v1
kind: ResourceQuota
metadata:
  name: xui-vpn-quota
  namespace: xui-vpn
spec:
  hard:
    # CPU limits
    requests.cpu: "2"        # Максимум 2 CPU cores на requests
    limits.cpu: "4"          # Максимум 4 CPU cores на limits
    
    # Memory limits
    requests.memory: 2Gi     # Максимум 2GB на requests
    limits.memory: 4Gi       # Максимум 4GB на limits
    
    # Storage
    requests.storage: 50Gi   # Максимум 50GB PVC storage
    persistentvolumeclaims: "5"  # Максимум 5 PVC
    
    # Objects count
    count/pods: "10"         # Максимум 10 подов
    count/services: "5"      # Максимум 5 сервисов
    count/secrets: "20"      # Максимум 20 secrets
    count/configmaps: "20"   # Максимум 20 configmaps

---
# LimitRange для namespace xui-vpn
# Устанавливает дефолтные и максимальные лимиты для подов/контейнеров
apiVersion: v1
kind: LimitRange
metadata:
  name: xui-vpn-limitrange
  namespace: xui-vpn
spec:
  limits:
    # Лимиты для контейнеров
    - type: Container
      default:
        # Дефолтные limits (если не указаны в Pod)
        cpu: 500m
        memory: 512Mi
      defaultRequest:
        # Дефолтные requests
        cpu: 100m
        memory: 256Mi
      max:
        # Максимальные значения для одного контейнера
        cpu: "2"
        memory: 2Gi
      min:
        # Минимальные значения
        cpu: 50m
        memory: 128Mi
    
    # Лимиты для подов
    - type: Pod
      max:
        cpu: "4"
        memory: 4Gi
    
    # Лимиты для PVC
    - type: PersistentVolumeClaim
      max:
        storage: 20Gi
      min:
        storage: 1Gi
